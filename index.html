<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Render Lock Test</title>

<style>
  body {
    margin: 0;
    background: black;
    color: white;
    font-family: monospace;
    text-align: center;
  }
  canvas {
    display: block;
    margin: 20px auto;
    border: 4px solid white;
    background: black;
  }
</style>
</head>

<body>
<h1>RENDER LOCK</h1>
<p>If you see text and a box, rendering is alive.</p>

<canvas id="game" width="512" height="512"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let x = 256;
let y = 256;
let vx = 1;
let vy = 0.7;

function safe(n) {
  return Number.isFinite(n);
}

function loop() {
  // HARD RESET DRAW STATE EVERY FRAME
  ctx.setTransform(1,0,0,1,0,0);
  ctx.globalAlpha = 1;
  ctx.lineWidth = 1;

  ctx.fillStyle = "black";
  ctx.fillRect(0,0,512,512);

  // PROOF TEXT (always visible)
  ctx.fillStyle = "red";
  ctx.font = "24px monospace";
  ctx.fillText("RENDER OK", 160, 40);

  // Update
  x += vx;
  y += vy;

  // HARD SANITY CHECK
  if (!safe(x) || !safe(y)) {
    ctx.fillStyle = "yellow";
    ctx.fillText("POSITION CORRUPTED", 110, 260);
    return;
  }

  // Draw box
  ctx.fillStyle = "cyan";
  ctx.fillRect(x - 20, y - 20, 40, 40);

  // Wrap
  if (x < 0) x += 512;
  if (x > 512) x -= 512;
  if (y < 0) y += 512;
  if (y > 512) y -= 512;

  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
